---
title: Transitioning to GUI'd Emacs on macOS
author: Ashton Wiersdorf
date: 2020-07-22
excerpt: I went on an adventure today. I left behind the stable comforts of the terminal and compiled bleeding-edge Emacs that uses a native window system. This is a big deal for me.
prepend_excerpt: false
tags: emacs
---

I went on an adventure today. I left behind the stable comforts of the terminal and compiled bleeding-edge Emacs that uses a native window system.

This is a big deal for me. As long as I can remember, I've used Emacs from within a terminal. I've decided to give the GUI'd Emacs a whirl.

## My Journey

I'm running macOS Catalina (10.15.5). Originally I tried using the pre-built packages via brew (`brew cask install emacs`) and those available at [Emacs for Mac OS X](https://emacsformacosx.com). However, all these pre-built binaries crashed on Catalina. I guess it's a problem with Catalina. ðŸ™„

So, I decided to try building from source. I cloned the Emacs source code directly from [Savannah](https://git.savannah.gnu.org/git/emacs.git):

    $ git clone https://git.savannah.gnu.org/git/emacs.git

I cd'd into that directory:

    $ cd emacs

At this point you've got the bleeding-edge development Emacs. You might want to check out and pull a different branch or tag. I decided to check out the [native-compilation](https://www.reddit.com/r/emacs/comments/g9vdd0/bringing_gnu_emacs_to_native_code_at_the_european/) branch:

    $ git checkout feature/native-comp
    $ git pull origin feature/native-comp

(I'm pretty sure those are the right commands; stuff got a little funky while I was building.)

I exported a magic[^1] environment variable that I got from a [helpful Emacs StackExchange post](https://emacs.stackexchange.com/a/54433/19088):

    $ export LIBXML2_CFLAGS="-I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/libxml2"

After exporting that variable, I ran `configure`:

    $ ./configure

Then I ran `make`:

    $ make

That will create a binary at `src/emacs` that you can run to test to make sure that all is working as it should. If you're satisfied with that emacs configuration, you can bundle it up into a stand-alone application:

    $ make install

This will create `Emacs.app` inside of the `nextstep/` directory. You are free to move that around:

    $ mv nextstep/Emacs.app /Applications/

I also went into `System Preferences > Security` and gave Emacs Full Disk Access. I heard of some people having difficulty accessing iCloud files from Emacs and this cleared it up. I haven't had any difficultyâ€”I just wanted Emacs to have full access anyway.

## Niceties

I still use the terminal a *lot* (though I might use it less directly if I can get comfortable with `ansi-term` mode) so I made a few shortcuts for myself:

 - I symlinked `/usr/local/bin/emacs` to `/Applications/Emacs.app/Contents/MacOS/Emacs`:

        $ cd /usr/local/bin
        $ ln -s /Applications/Emacs.app/Contents/MacOS/Emacs emacs

   `/usr/local/bin` is already in my `PATH`, so now I can just type `emacs` on the command line and it will fire it up just as it used to

 - I created an alias like this in my `.zshrc` file:
 
        alias 'e'='emacs -nw'
    
   That way, when I'm in a terminal and type `e <filename>` it will open up the file in Emacs *in the terminal*. I might change that behavior at some point in the future, but that will help me transition for the time being.

 - I installed the [exec-path-from-shell package](https://github.com/purcell/exec-path-from-shell) so that Emacs could fire off processes like `elixir` when using `lsp-mode`. Otherwise, you get errors like this inside the `*lsp::stderr*` buffer:
 
        line 66: exec: elixir: not found

## Conclusion

Why did I do this? Because I was a little bored. I also wanted to experiment with some of the more extensive key binding opportunities that a full-bodied Emacs offers.

I'll write updates to my blog as time goes on. I might decide to switch back to regular-old Emacs in the terminal. Right now, however, I'm enjoying the GUI'd version.

You can see my Emacs config on [my GitHub](https://github.com/ashton314/.dotfiles). Feel free to drop me a line if you have any questions.

[^1]: I'm not entirely sure what it does. I know that it didn't work before using this environment variable, and now it works after I tried using it.
